import{f as H,a as J,i as K,b as Q,p as q,_ as W}from"./index-7ec2b6b9.js";import{d as D,r as S,o as B,e as L,f as e,j as o,k as l,F as X,g as Y,v as G,G as Z,H as ee,I as M,J as R,K as A,L as oe,a as P,c as te,w as se,M as ne,t as d,u as g,N as ae,O as le,P as ie,y as ce,z as de,Q as $,R as _e}from"./element-plus-5455aaa7.js";const ue={class:"config"},re=e("h2",null,"转换配置:",-1),me={class:"operate"},pe=D({__name:"Transcoding",props:{onFinish:{type:Function}},setup(_){const t=_,m=["mp4","webm","ogg","avi","mov","flv","wmv","mkv","m4v","3gp","3g2","ts","mts","m2ts","vob","mxf","rm","rmvb","f4v"],a=S({format:"mp4",kbps:1e3});function w(){t.onFinish(a)}return(p,n)=>{const c=Z,x=ee,v=M,F=R,y=A,k=oe;return B(),L("div",null,[e("div",ue,[re,o(y,{"label-position":"left","label-width":"100px",model:a},{default:l(()=>[o(v,{label:"输出格式"},{default:l(()=>[o(x,{filterable:"",modelValue:a.format,"onUpdate:modelValue":n[0]||(n[0]=s=>a.format=s),placeholder:"请选择"},{default:l(()=>[(B(),L(X,null,Y(m,s=>o(c,{key:s,label:s,value:s},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(v,{label:"码率"},{default:l(()=>[o(F,{placeholder:"请输入",modelValue:a.kbps,"onUpdate:modelValue":n[1]||(n[1]=s=>a.kbps=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),e("div",me,[o(k,{type:"primary",onClick:w},{default:l(()=>[G(" 输出 ")]),_:1})])])}}}),i=_=>(ce("data-v-0f23d227"),_=_(),de(),_),ve=["element-loading-text"],fe={class:"info"},he=i(()=>e("h2",null,"基本信息:",-1)),be={class:"row"},ge=i(()=>e("div",{class:"label"},"文件名:",-1)),we={class:"value"},Ve={class:"row"},xe=i(()=>e("div",{class:"label"},"文件大小:",-1)),Fe={class:"value"},ye={class:"row"},ke=i(()=>e("div",{class:"label"},"视频时长:",-1)),Ee={class:"value"},Te={class:"row"},Ie=i(()=>e("div",{class:"label"},"解码器:",-1)),Se={class:"value"},Be={class:"row"},Le={class:"label"},Ne={class:"value"},Ce={class:"info"},Oe=i(()=>e("h2",null,"视频流信息:",-1)),Ue={class:"row"},je=i(()=>e("div",{class:"label"},"文件名:",-1)),ze={class:"value"},Pe={class:"info"},$e=i(()=>e("h2",null,"音频流信息:",-1)),De={class:"row"},Ge=i(()=>e("div",{class:"label"},"文件名:",-1)),Me={class:"value"},Re={class:"config"},Ae=i(()=>e("h2",null,"通用导出配置:",-1)),He={class:"operate"},Je=D({__name:"Video",setup(_){let t=null,m="";const a=S({name:"output"}),w=P("transcoding"),p=P({audio:{},video:{},basic:{duration:0,bitrate:0,encoder:"",majorBrand:""}}),n=S({value:!1,text:"Loading"}),c=te(()=>J.value[0]);async function x(){n.value=!0,n.text="初始化编解码器中...",t=await K(),n.value=!1}se(c,async()=>{c.value&&(m&&(t==null||t.FS("unlink",m)),await v())});async function v(){n.value=!0,n.text="获取视频信息中...";const s=c.value,u=await Q(s.raw),V=[];t==null||t.FS("writeFile",s.name,u),m=s.name,t==null||t.setLogger(({type:h,message:b})=>{h!=="ffout"&&V.push(b)}),await(t==null?void 0:t.run("-i",s.name));const f=q(V);if(console.log(f),f.length===0)$.error({title:"错误",message:"获取视频信息失败"});else{$.success({title:"成功",message:"获取视频信息成功"});const{duration:h,encoder:b,majorBrand:r}=f[0]??{},{duration:E,bitrate:T}=h??{};p.value.basic={duration:E,bitrate:T,encoder:b,majorBrand:r}}n.value=!1}async function F(){console.log("初始化编码器"),await x(),await v()}F();function y(){}function k(s){console.log("%c [ config ]-70","font-size:13px; background:pink; color:#bf2c9f;",s)}return(s,u)=>{var N,C,O,U,j,z;const V=ae,f=R,h=M,b=A,r=_e,E=le,T=ie;return ne((B(),L("div",{class:"video","element-loading-text":n.text},[e("div",fe,[he,e("div",be,[ge,e("div",we,d(g(c).name),1)]),e("div",Ve,[xe,e("div",Fe,d(g(H)(g(c).size)),1)]),e("div",ye,[ke,e("div",Ee,d((C=(N=p.value)==null?void 0:N.basic)==null?void 0:C.duration),1)]),e("div",Te,[Ie,e("div",Se,d((U=(O=p.value)==null?void 0:O.basic)==null?void 0:U.encoder),1)]),e("div",Be,[e("div",Le,[o(V,{content:"详见 http://ftyps.com/"},{default:l(()=>[G(" ftyp: ")]),_:1})]),e("div",Ne,d((z=(j=p.value)==null?void 0:j.basic)==null?void 0:z.majorBrand),1)])]),e("div",Ce,[Oe,e("div",Ue,[je,e("div",ze,d(g(c).name),1)])]),e("div",Pe,[$e,e("div",De,[Ge,e("div",Me,d(g(c).name),1)])]),e("div",Re,[Ae,o(b,{"label-position":"left","label-width":"100px",model:a},{default:l(()=>[o(h,{label:"输出名称"},{default:l(()=>[o(f,{placeholder:"请输入",modelValue:a.name,"onUpdate:modelValue":u[0]||(u[0]=I=>a.name=I)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),e("div",He,[o(E,{modelValue:w.value,"onUpdate:modelValue":u[1]||(u[1]=I=>w.value=I),onTabClick:y},{default:l(()=>[o(r,{name:"transcoding",label:"转换"},{default:l(()=>[o(pe,{"on-finish":k})]),_:1}),o(r,{name:"Config",label:"提取字幕"}),o(r,{name:"Role",label:"提取音频"}),o(r,{name:"waterMark",label:"水印"})]),_:1},8,["modelValue"])])],8,ve)),[[T,n.value]])}}});const qe=W(Je,[["__scopeId","data-v-0f23d227"]]);export{qe as default};
